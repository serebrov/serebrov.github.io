<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Local Amazon DynamoDB - tools, dump/restore and testing</title>

    <!-- Bootstrap -->
    <!-- https://github.com/necolas/normalize.css -->
    <link href="/css/normalize.css" rel="stylesheet">
    <!-- https://github.com/oxalorg/sakura -->
    <link href="/css/sakura.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/custom.css"/>

    <!-- https://prismjs.com/ -->
    <!-- Plugins: Line Highlight, Line Numbers, Autolinker, File Highlight,
                  Keep Markup, Normalize Whitespace
    -->
    <!-- Langs: bash, c, cpp, docker, go, haskell, json, makefile, php, plsql,
                python, rust, smalltalk, sql, vim, yaml
    -->
    <link href="/css/prism.css" rel="stylesheet">
    <script src="/js/prism.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  </head>
  <body>
    <div class="content">
      <div class="page-header">
        <a href="/">vim, git, aws and other three-letter words</a>
      </div>
      <div class="post-title">
          <h1>Local Amazon DynamoDB - tools, dump/restore and testing</h1>
      </div>
      <div class="post-body">
          <h3 id="setup">Setup</h3>
<p><a href="http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/Tools.DynamoDBLocal.html">Download</a> and extract dynamodb local to some folder.</p>
<p>Launch it (-sharedDb allows us to connect to the same database with other tools):</p>
<pre><code class="lang-bash">    $ java -Djava.library.path=./DynamoDBLocal_lib -jar DynamoDBLocal.jar -sharedDb
</code></pre>
<p>By default it will be running on the port 8000 and will create the db file in the same directory where it was launched.
<!-- more --></p>
<p>Without the <code>-sharedDB</code> parameter the DB file name depends on connection parameters, the name is <code>{aws_access_key_id}_{region_name}.db</code>.
So different clients can use different databases.</p>
<p>There is also an <code>-inMemory</code> parameter to keep data in memory:</p>
<pre><code class="lang-bash">    $ java -Djava.library.path=./DynamoDBLocal_lib -jar DynamoDBLocal.jar - inMemory -sharedDb
</code></pre>
<h3 id="how-to-load-a-test-data-and-dump-restore-the-data">How to load a test data and dump/restore the data</h3>
<p>The easiest way is to create some script to generate the test data.
This way it is possible to run DynamoDB local in memory and populate it with test data after launch.
Another way is to dump real db data and restore it into local DB. Here are some related tools to help with this and similar tasks:</p>
<ul>
<li><a href="https://github.com/bchew/dynamodump">dynamodump - Simple backup and restore for Amazon DynamoDB using boto</a></li>
<li><a href="https://github.com/adamchainz/dynamodb_utils">dynamodb_utils - A toolchain for Amazon&#39;s DynamoDB to make common operations (backup, restore backups) easier</a></li>
<li><a href="https://github.com/edasque/DynamoDBtoCSV">DynamoDBtoCSV - Dump DynamoDB data into a CSV file</a> and <a href="http://www.frenchguys.com/wordpress/exporting-dynamodb-data-to-csv/">related blog post</a></li>
<li><a href="https://github.com/yegor256/dynamo-archive">dynamo-archive - Archive and Restore DynamoDB Tables</a></li>
<li><a href="https://github.com/JasonGhent/AWS-DynamoDB-to-MongoDB">AWS DynamoDB to MongoDB Conversion</a></li>
</ul>
<h3 id="dynamodb-local-web-shell">DynamoDb local web shell</h3>
<p>DynamoDB local also has a web shell available via <a href="http://localhost:8000/shell">http://localhost:8000/shell</a>.
Make sure you launched the database with a <code>-sharedDb</code> flag.</p>
<p>Without the <code>-sharedDb</code> it will use <code>{access_key}_us-west-2.db</code> file.
Access key can be set in shell settings, but the region name is hard-coded as <code>us-west-2</code> (see source in chrome dev tools, /shell/jsrepl/sandbox.js file).</p>
<h3 id="aws-explorer">AWS Explorer</h3>
<p><a href="http://docs.aws.amazon.com/AWSToolkitEclipse/latest/GettingStartedGuide/Welcome.html">AWS Explorer</a> is a toolkit for eclipse which contains the DynamoDb GUI.</p>
<p>Install it as described <a href="http://docs.aws.amazon.com/AWSToolkitEclipse/latest/GettingStartedGuide/tke_setup_install.html">here</a>.</p>
<p>To browse an application database start the DynamoDb local with the <code>-sharedDb</code> flag and select &#39;local&#39; region in the AWS regions dropdown.</p>
<p>Without the <code>-sharedDb</code> Eclipse will use a file like <code>AKXAX4X6XAFXIXNIXEXA_local.db</code>.</p>
<h3 id="table-prefixes">Table prefixes</h3>
<p>DynamoDB has a single namespace for all tables, so it is better to use table prefixes for different environments and/or different applications.</p>
<h3 id="dynamodb-mocks-and-testing">DynamoDB mocks and testing</h3>
<p>While tools mentioned above are good to examine the data generated by your application the simplest way to verify your code is to build a set of unit tests.</p>
<p>DynamoDB Local is too slow for unit tests and it is better to use some other dynamo mock. In my current project I use a custom mock which is a simplified boto API implementation. Try to search for some native implementation of the dynamo API in your project language which will hold all the data in memory.</p>
<p>Also, a good idea is to make DB access configurable for tests so it will be easy to switch tests between mock / local db / real db.</p>
<p>DynamoDB Mocks:</p>
<ul>
<li><a href="http://aws.amazon.com/blogs/aws/amazon-dynamodb-libraries-mappers-and-mock-implementations-galore/">Amazon DynamoDB Libraries, Mappers, and Mock Implementations Galore!</a></li>
<li><a href="https://pypi.python.org/pypi/ddbmock">ddbmock - Amazon DynamoDB mock implementation (python)</a> and a <a href="https://bitbucket.org/Ludia/dynamodb-mock/overview">bitbucket repository</a></li>
<li><a href="https://github.com/mhart/dynalite">dynalite - A mock implementation of Amazon&#39;s DynamoDB built on LevelDB</a></li>
</ul>

      </div>
      <div>
<a href="https://stackexchange.com/users/261528">
<img src="https://stackexchange.com/users/flair/261528.png?theme=clean" width="208" height="58" alt="profile for Boris Serebrov on Stack Exchange, a network of free, community-driven Q&amp;A sites" title="profile for Boris Serebrov on Stack Exchange, a network of free, community-driven Q&amp;A sites">
</a>
      </div>
      <div>
<div id="disqus_thread"></div>
<script>
var disqus_config = function () {
this.page.url = 'https://serebrov.github.io/html/2015-02-01-dynamodb-local.html';  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = 'html/2015-02-01-dynamodb-local.html'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://serebrov.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
      </div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-58056088-1', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>

